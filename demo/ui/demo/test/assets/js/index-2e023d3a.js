import{B as D,D as $,b as M,F as S,G as F}from"./element-plus-0a8efd0e.js";import{d as b,K as N,c as v,Q as U,a9 as z,T as V,Y as w,o as p,a as m,P as d,S as k,u as C,X as E,M as P,e as x,w as T,au as A,j as y,$ as G}from"./@vue-310af8a3.js";import{F as O,G as Q,H as j}from"./@element-plus-812d5de9.js";import{_ as B}from"./_plugin-vue_export-helper-3b972a90.js";import{e as h,h as H,m as K,p as R,b as X}from"./undraw-ui-ee3df5dd.js";import{s as Y}from"./axios-bad3ccfa.js";import"./lodash-es-f1a2ed4d.js";import"./async-validator-a02340b6.js";import"./@vueuse-bc5643fd.js";import"./dayjs-36e6de4f.js";import"./@sxzz-ce685267.js";import"./normalize-wheel-es-dcaa6c76.js";import"./@ctrl-3f430a5f.js";import"./axios-77b6ca81.js";import"./nprogress-2db98fbf.js";/*! Version: v0.0.0 */const q={class:"viewer"},J={class:"upload-item u-upload__wrapper"},W={class:"image"},Z={class:"action select-none flex-center"},ee={class:"progress-bar"},te={class:"progress-value"},se={class:"tag"},ae=b({__name:"viewer",props:{data:{}},setup(c){const l=N({index:0,show:!1});function u(r){l.index=r,l.show=!0}function n(r){return r.substring(r.lastIndexOf(".")+1).split(/(\?|&)/)[0]}return(r,s)=>{const o=$,e=M,a=S,i=D;return p(),v("div",q,[(p(!0),v(U,null,z(r.data,(t,f)=>(p(),v("div",J,[m("div",W,[m("div",Z,[d(o,{onClick:_=>u(f)},{default:k(()=>[d(C(O))]),_:2},1032,["onClick"]),d(o,{onClick:_=>r.data.splice(f,1)},{default:k(()=>[d(C(Q))]),_:2},1032,["onClick"])]),d(e,{src:t.url,class:"img",fit:"contain"},null,8,["src"])]),m("div",{class:P(["progress flex-center",{"is-show":t.progress>=0&&t.progress<100,"is-hide":t.progress==100}])},[m("div",ee,[d(a,{percentage:t.progress,"show-text":!1},null,8,["percentage"])]),m("span",te,E(t.progress),1)],2),m("span",se,E(n(t.name||t.url)),1)]))),256)),l.show?(p(),V(i,{key:0,"initial-index":l.index,"url-list":r.data.map(t=>t.url),onClose:s[0]||(s[0]=()=>l.show=!1)},null,8,["initial-index","url-list"])):w("",!0)])}}});const I=B(ae,[["__scopeId","data-v-b75550e3"]]);function oe(c="u-theme"){const l=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",u=h.get(c),n=window.matchMedia("(prefers-color-scheme: dark)"),r=x(u==="dark"||u==="auto"&&l==="dark"),s=x(!1);T(()=>{r.value?(document.documentElement.classList.add("dark"),s.value||(l=="dark"?h.set(c,"auto"):h.set(c,"dark"))):(document.documentElement.classList.remove("dark"),s.value||(l=="light"?h.set(c,"auto"):h.set(c,"light"))),s.value=!1});const o=e=>{h.get(c)=="auto"&&(s.value=!0,r.value=e.matches)};return n.addEventListener("change",o),r}x(oe());const L=c=>isNaN(c)||c==null?c:c+"px",le={class:"u-upload"},ne={key:1,class:"box u-upload__wrapper select-none"},re=b({__name:"index",props:{title:{default:"上传文件"},accept:{},width:{default:100},height:{default:100},modelValue:{},multiple:{type:Boolean}},emits:["change","update:modelValue"],setup(c,{emit:l}){const u=c;A(e=>({"2106ef00":s.value,"33f011a6":o.value}));const n=y({get(){return u.modelValue},set(e){l("update:modelValue",e)}});setTimeout(()=>{console.log(n.value)},300);const r=(e,a)=>{const i=e.raw;let t={url:H(i),name:i.name,progress:0};u.multiple||(n.value.length=0),n.value.push(t);const f=n.value.length-1;let _=n.value[f];console.log(_),_.id=K(),l("change",i,g=>{g==-1&&R(n.value,"id",_.id),_.progress=g,console.log("change",n.value,g,t)})},s=y(()=>L(u.width)),o=y(()=>L(u.height));return(e,a)=>{const i=$,t=F;return p(),v("div",le,[e.multiple?(p(),V(I,{key:0,class:"viewer-multiple",data:n.value},null,8,["data"])):w("",!0),d(t,{drag:"",class:"u-upload__box","show-file-list":!1,"auto-upload":!1,accept:".png,.jepg,.jpg,.webp,.gif,.svg","on-change":r,multiple:e.multiple},{default:k(()=>[e.multiple?w("",!0):(p(),V(I,{key:0,data:n.value,onClick:a[0]||(a[0]=G(()=>{},["stop"]))},null,8,["data"])),n.value.length<1||e.multiple?(p(),v("div",ne,[d(i,{class:"icon"},{default:k(()=>[d(C(j))]),_:1}),m("span",null,E(e.title),1)])):w("",!0)]),_:1},8,["multiple"])])}}});const ie=B(re,[["__scopeId","data-v-165432e2"]]),Ce=b({name:"upload",__name:"index",setup(c){const l=x([]);setTimeout(()=>{l.value=[{url:"http://192.168.1.165:7032/static/basic/2024/11/14/180683466097168384.png"}]},200);function u(s,o=!1){s=X(s);const e=new URLSearchParams;for(const a in s)if(s.hasOwnProperty(a)){const i=s[a];Array.isArray(i)?o?e.append(a,i.join(",")):i.forEach(t=>{e.append(a,t)}):e.append(a,i)}return e.toString()}function n(s,o="get"){let e={url:s,method:o,progress:!1,paramsSerializer:a=>u(a)};return(a,i)=>(o=="get"?e.params=a:e.data=a,Y({...e,onUploadProgress(t){const f=t.total,_=t.loaded,g=t.total?Math.floor(t.loaded/t.total*100):0;i==null||i(g),console.log(f,_,g)}}).then(t=>t.data))}const r=(s,o)=>{const e=new FormData;e.append("file",s),n("/file/upload","post")(e,a=>o(a)).catch(a=>o(-1))};return(s,o)=>(p(),v("div",null,[d(ie,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),onChange:r},null,8,["modelValue"])]))}});export{Ce as default};
